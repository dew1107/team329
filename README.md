# Federated Multimodal Learning Project

## í”„ë¡œì íŠ¸ ì†Œê°œ

ë³¸ í”„ë¡œì íŠ¸ëŠ” "ì„œë¡œ ë‹¤ë¥¸ ì¢…ë¥˜ì˜ ë°ì´í„°(ëª¨ë‹¬ë¦¬í‹°)" ë¥¼ ë³´ìœ í•œ ì—¬ëŸ¬ í´ë¼ì´ì–¸íŠ¸ê°€ ìì‹ ì˜ ë°ì´í„°ë¥¼ ì§ì ‘ ê³µìœ í•˜ì§€ ì•Šê³ ë„ í•¨ê»˜ AI ëª¨ë¸ì„ í•™ìŠµí•  ìˆ˜ ìˆë„ë¡ ì„¤ê³„ëœ ì—°í•© í•™ìŠµ(Federated Learning) ì‹œìŠ¤í…œì…ë‹ˆë‹¤.



> MRI ì˜ìƒë§Œ ìˆëŠ” ë³‘ì›, ì§„ë£Œ ê¸°ë¡ë§Œ ìˆëŠ” ë³‘ì›, ë‘˜ ë‹¤ ê°€ì§„ ë³‘ì›ì´ ìˆë‹¤ê³  ê°€ì •í•´ ë³´ê² ìŠµë‹ˆë‹¤.
ì´ ë³‘ì›ë“¤ì´ ìì‹ ì˜ ë°ì´í„°ëŠ” ì™¸ë¶€ì— ìœ ì¶œí•˜ì§€ ì•Šìœ¼ë©´ì„œë„, ë˜‘ë˜‘í•œ AI ì§„ë‹¨ ëª¨ë¸ì„ í•¨ê»˜ í•™ìŠµí•  ìˆ˜ ìˆëŠ” ë°©ë²•,
ê·¸ê²ƒì´ ë°”ë¡œ ë³¸ í”„ë¡œì íŠ¸ì˜ í•µì‹¬ì…ë‹ˆë‹¤.

í˜„ëŒ€ ì˜ë£Œ í™˜ê²½ì—ì„œëŠ” X-ray ì´ë¯¸ì§€ì™€ ì§„ë‹¨ ë³´ê³ ì„œ(í…ìŠ¤íŠ¸)ì²˜ëŸ¼ í•œ í™˜ìì— ëŒ€í•´ ì—¬ëŸ¬ í˜•íƒœì˜ ë°ì´í„°(ë©€í‹°ëª¨ë‹¬)ê°€ ìˆ˜ì§‘ë©ë‹ˆë‹¤. í•˜ì§€ë§Œ ì´ ì¤‘ ì¼ë¶€ ë°ì´í„°ê°€ ëˆ„ë½ë˜ëŠ” 'ê²°ì† ì–‘ìƒ(Missing Modality)' ë¬¸ì œê°€ ìì£¼ ë°œìƒí•˜ë©°, ì´ëŠ” ì˜ë£Œ AI ëª¨ë¸ì˜ ì •í™•ì„±ê³¼ ì‹ ë¢°ë„ë¥¼ ë–¨ì–´ëœ¨ë¦¬ëŠ” ì£¼ëœ ì›ì¸ì´ ë©ë‹ˆë‹¤.

### ë°ì´í„°ì˜ ë¶ˆì™„ì „ì„±
- **í•µì‹¬ ë¬¸ì œ**: íŠ¹ì • í™˜ìì˜ ì˜ë£Œ ë°ì´í„° ì¤‘ ì´ë¯¸ì§€ë‚˜ í…ìŠ¤íŠ¸ ë³´ê³ ì„œ ì¤‘ í•˜ë‚˜ê°€ ì—†ëŠ” ê²½ìš°, AIê°€ ì •í™•í•œ ì˜ˆì¸¡ì„ í•˜ê¸° ì–´ë µìŠµë‹ˆë‹¤.

- **ê²°ê³¼**: ê° ë³‘ì›ì´ ë³´ìœ í•œ ë°ì´í„°ì˜ íŠ¹ì„±ì— ë”°ë¼ AI ì„±ëŠ¥ì´ ë‹¬ë¼ì§‘ë‹ˆë‹¤. íŠ¹íˆ, íŠ¹ì • ë³‘ì›ì—ì„œ ë“œë¬¼ê²Œ ê´€ì°°ë˜ëŠ” ì§ˆí™˜ì— ëŒ€í•´ì„œëŠ” AIê°€ í˜„ì €íˆ ë‚®ì€ ì„±ëŠ¥ì„ ë³´ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### í•´ê²° ì „ëµ: ì—°í•©í•™ìŠµ(FL)ê³¼ FD ê¸°ìˆ ì˜ ê²°í•©
ì´ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ **ì—°í•©í•™ìŠµ(Federated Learning, FL)** ê³¼ **FD(Fusion for Missing Modality/Failure-robust Design)** ê¸°ìˆ ì„ ê²°í•©í•˜ëŠ” ë°©ì•ˆì´ ì£¼ëª©ë°›ê³  ìˆìŠµë‹ˆë‹¤.

- **ì—°í•©í•™ìŠµ (FL)**: ì—¬ëŸ¬ ë³‘ì›ì´ ë¯¼ê°í•œ í™˜ì ë°ì´í„°ë¥¼ ì§ì ‘ ê³µìœ í•˜ì§€ ì•Šê³ , ê°ì í•™ìŠµì‹œí‚¨ AI ëª¨ë¸ì˜ ì¼ë¶€ ì •ë³´(íŒŒë¼ë¯¸í„°)ë§Œì„ ê³µìœ í•´ í˜‘ë ¥í•˜ëŠ” ê¸°ìˆ ì…ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ê°œì¸ì •ë³´ë¥¼ ë³´í˜¸í•˜ë©´ì„œ ë” ë˜‘ë˜‘í•œ AIë¥¼ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

- **FD ê¸°ìˆ ((Fusion for Missing Modality/Failure-robust Design)**: ì´ë¯¸ì§€ì™€ í…ìŠ¤íŠ¸ ë“± ì„œë¡œ ë‹¤ë¥¸ ì¢…ë¥˜ì˜ ë°ì´í„°ë¥¼ ìœµí•©í•˜ê³ , íŠ¹ì • ë°ì´í„°ê°€ ì—†ë”ë¼ë„ ì„±ëŠ¥ ì €í•˜ë¥¼ ìµœì†Œí™”í•˜ë„ë¡ ë³´ì™„í•˜ëŠ” ê¸°ìˆ ì…ë‹ˆë‹¤.

ê²°ë¡ ì ìœ¼ë¡œ, ì—°í•©í•™ìŠµê³¼ FD ê¸°ìˆ ì„ í•¨ê»˜ ì‚¬ìš©í•˜ë©´, ë³‘ì›ë§ˆë‹¤ ë°ì´í„°ì˜ ì¢…ë¥˜ì™€ ì–‘ì´ ë‹¤ë¥´ê±°ë‚˜ ë°ì´í„°ê°€ ë¶ˆì™„ì „í•œ ìƒí™©ì—ì„œë„ ì•ˆì •ì ì´ê³  ì‹ ë¢°ë„ ë†’ì€ ì˜ë£Œ AIë¥¼ ê°œë°œí•  ìˆ˜ ìˆëŠ” íš¨ê³¼ì ì¸ í•´ê²°ì±…ì´ ë©ë‹ˆë‹¤.

## ì „ì²´ êµ¬ì¡°
```
CLIENT_ROOT/
â”‚
â”œâ”€â”€ client_0/
â”‚   â”œâ”€â”€ train/   â† ì´ë¯¸ì§€ ë˜ëŠ” í…ìŠ¤íŠ¸ ë“±ì˜ í•™ìŠµ ë°ì´í„°
â”‚   â”œâ”€â”€ val/     â† ê²€ì¦ìš© ë°ì´í„°
â”‚   â”œâ”€â”€ best_model.pt â† í•™ìŠµëœ ë¡œì»¬ ëª¨ë¸
â”‚
â”œâ”€â”€ ...
â”œâ”€â”€ server/
â”‚   â””â”€â”€ global_vectors/ â† í´ë¼ì´ì–¸íŠ¸ë“¤ì´ ì—…ë¡œë“œí•œ ë²¡í„° ì •ë³´
```

## ëª¨ë¸ êµ¬ì¡° (Fusion Classifier)
- ì´ë¯¸ì§€ ì¸ì½”ë”: MobileNet V3

- í…ìŠ¤íŠ¸ ì¸ì½”ë”: BERT Tiny

- ìœµí•© ë°©ì‹: late fusion + gating mechanism
â†’ ë‘ ë²¡í„°ë¥¼ ë‹¨ìˆœíˆ í•©ì¹˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼, ê°€ì¤‘ì¹˜ë¥¼ ì¡°ì ˆí•˜ì—¬ ì¤‘ìš”í•œ ì •ë³´ì— ë” ì§‘ì¤‘í•˜ë„ë¡ ì„¤ê³„í•˜ì˜€ìŠµë‹ˆë‹¤.

## í•™ìŠµ íë¦„
### ë¡œì»¬ í•™ìŠµ

í´ë¼ì´ì–¸íŠ¸ëŠ” ìì‹ ì˜ ë°ì´í„°ë§Œì„ í™œìš©í•˜ì—¬ ëª¨ë¸ì„ í•™ìŠµí•©ë‹ˆë‹¤.

### ì§€ì‹ ì¦ë¥˜
í´ë¼ì´ì–¸íŠ¸ë¥¼ threshold ê¸°ë°˜ìœ¼ë¡œ ë‚˜ëˆ„ì–´ ê·¸ë£¹í•‘ í›„ ì„±ëŠ¥ì´ ë” ë›°ì–´ë‚œ ì„ ìƒ ëª¨ë¸ì´ í•™ìƒ ëª¨ë¸ì—ê²Œ logit ì„ ì „ë‹¬í•©ë‹ˆë‹¤.

### ê¸€ë¡œë²Œ ë²¡í„° ì—…ë¡œë“œ

í•™ìŠµëœ ê²°ê³¼ ì¤‘ í•µì‹¬ ì •ë³´(ë²¡í„°)ë¥¼ ì„œë²„ì— ì „ì†¡í•©ë‹ˆë‹¤.

### ì„œë²„ ì¸¡ ìœµí•©

ì„œë²„ëŠ” ì—¬ëŸ¬ í´ë¼ì´ì–¸íŠ¸ì˜ ë²¡í„°ë¥¼ ëª¨ì•„ ì „ì—­ ì •ë³´ë¥¼ êµ¬ì„±í•©ë‹ˆë‹¤.

### ê¸€ë¡œë²Œ ì •ë³´ ë°˜ì˜

í´ë¼ì´ì–¸íŠ¸ëŠ” ì´ ì „ì—­ ì •ë³´ë¥¼ í™œìš©í•˜ì—¬ ë¶€ì¡±í•œ ëª¨ë‹¬ë¦¬í‹°ë¥¼ ë³´ì™„í•©ë‹ˆë‹¤.

### ë°˜ë³µ í•™ìŠµ

ìœ„ ê³¼ì •ì„ ì—¬ëŸ¬ ì°¨ë¡€ ë°˜ë³µí•¨ìœ¼ë¡œì¨ ì „ì²´ ëª¨ë¸ ì„±ëŠ¥ì„ ì ì°¨ í–¥ìƒì‹œí‚µë‹ˆë‹¤.

## ì½”ë“œ ì²´ê³„
### ğŸ“ 1. Local Area (ë¡œì»¬ í•™ìŠµ ì˜ì—­)

ê° í´ë¼ì´ì–¸íŠ¸ëŠ” ë‹¤ìŒ ì¤‘ í•˜ë‚˜ì˜ ëª¨ë‹¬ë¦¬í‹° êµ¬ì„±ì— í•´ë‹¹í•©ë‹ˆë‹¤:

- Image-only (2 clients)

- Text-only (2 clients)

- Image+Text (26 clients)

ì‚¬ìš©ëœ ëª¨ë¸:

- MobileNetV3: ì´ë¯¸ì§€ ì¸ì½”ë”

- BERT Mini: í…ìŠ¤íŠ¸ ì¸ì½”ë”

ìˆ˜í–‰ ë¡œì§:

- ê³µí†µ ë°ì´í„°ì…‹(ì„œë²„ì—ì„œ ë¶„ë°°ë¨)ì„ í†µí•´ ê° í´ë¼ì´ì–¸íŠ¸ê°€ ë¡œì»¬ í•™ìŠµ ìˆ˜í–‰

- image_encoder() / text_encoder()ë¥¼ í†µí•´ í‘œí˜„ ë²¡í„° ì¶”ì¶œ

- í´ë¼ì´ì–¸íŠ¸ë³„ë¡œ local encoder output ì €ì¥ (e.g., img_vec.pt, txt_vec.pt)

### ğŸ“ 2. Global Area (í´ëŸ¬ìŠ¤í„°ë§ ë° ìœµí•© ì˜ì—­)
í‘œí˜„ ë²¡í„° ìˆ˜ì§‘ ë° í´ëŸ¬ìŠ¤í„°ë§:

- ê° í´ë¼ì´ì–¸íŠ¸ë¡œë¶€í„° ìˆ˜ì§‘ëœ ì´ë¯¸ì§€/í…ìŠ¤íŠ¸ ë²¡í„°ì— ëŒ€í•´ K-Means ì ìš©

- Hungarian Algorithmìœ¼ë¡œ cross-modality pair ìµœì í™”

**Late Fusion:**

- ê° modality í´ëŸ¬ìŠ¤í„°ì—ì„œ ì¤‘ì‹¬ ë²¡í„°(center vector)ë¥¼ ì¶”ì¶œí•˜ì—¬ Late Fusion

**Cross-Attention & Gating:**

- CrossAttentionTransformer: ì´ë¯¸ì§€-í…ìŠ¤íŠ¸ ì¤‘ì‹¬ ë²¡í„° ê°„ í•µì‹¬ ì •ë³´ Z ì¶”ì¶œ

- GatingMechanism: forget gate ê¸°ë°˜ìœ¼ë¡œ ìµœì¢… í†µí•© í‘œí˜„ R ìƒì„±

### ğŸ“ 3. Classification & Global Update (ë¶„ë¥˜ ë° ê¸€ë¡œë²Œ ì—…ë°ì´íŠ¸ ì˜ì—­)
ë¶„ë¥˜:

- í†µí•© í‘œí˜„ Rì„ ì…ë ¥ìœ¼ë¡œ í•˜ëŠ” FusionClassifier ìˆ˜í–‰

- Cross-entropy lossë¡œ ìµœì¢… classification ê²°ê³¼ ë„ì¶œ

**ê¸€ë¡œë²Œ ì—…ë°ì´íŠ¸:**

- í´ë¼ì´ì–¸íŠ¸ë³„ adapter layer(Fusion Classifier ì•ë‹¨) ì„±ëŠ¥ ê¸°ë°˜ ê¸°ì—¬ë„ë¥¼ ê³„ì‚°

- ê³„ì‚°ëœ ê¸°ì—¬ë„ë¥¼ ë°”íƒ•ìœ¼ë¡œ ê°€ì¤‘ í‰ê·  ë°©ì‹ìœ¼ë¡œ ê¸€ë¡œë²Œ ëª¨ë¸ ì—…ë°ì´íŠ¸

- adapter weight(ë¡œì»¬ì—ì„œ ìƒˆë¡œ ê³„ì‚°ëœ weight)ëŠ” ì„œë²„ì—ì„œ í†µí•© í›„ ì¬ë°°í¬í•˜, local encoderëŠ” í´ë¼ì´ì–¸íŠ¸ê°€ ìœ ì§€

`classification_01.jpynb` 
| íŒŒì¼ / í•¨ìˆ˜ëª…                      | ì„¤ëª…                                              |
| ----------------------------- | ----------------------------------------------- |
| `run_client_training()`       | ê° í´ë¼ì´ì–¸íŠ¸ì—ì„œ ë¡œì»¬ í•™ìŠµ ìˆ˜í–‰                              |
| `extract_representations()`   | MobileNetV3 / BERT Minië¡œ ì´ë¯¸ì§€/í…ìŠ¤íŠ¸ ë²¡í„° ì¶”ì¶œ          |
| `run_clustering_and_fusion()` | K-Means, Hungarian ì•Œê³ ë¦¬ì¦˜ ë° Cross-Attention ìœµí•© ì²˜ë¦¬ |
| `FusionClassifier`            | ìµœì¢… í†µí•© í‘œí˜„ Rì— ëŒ€í•œ ë¶„ë¥˜ê¸°                              |
| `global_update()`             | í´ë¼ì´ì–¸íŠ¸ë³„ ê°€ì¤‘ì¹˜ ë°˜ì˜ í›„ ê¸€ë¡œë²Œ ëª¨ë¸ ì—…ë°ì´íŠ¸                     |


## ê¸°ëŒ€ íš¨ê³¼

- **ëª¨ë‹¬ë¦¬í‹° ê²°ì† ìƒí™©ì—ì„œë„ ì„±ëŠ¥ ìœ ì§€**

ì´ë¯¸ì§€ ë˜ëŠ” í…ìŠ¤íŠ¸ê°€ ëˆ„ë½ëœ ìƒíƒœì—ì„œë„ ì•ˆì •ì ìœ¼ë¡œ ì§„ë‹¨ ì˜ˆì¸¡ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆì–´, ì‹¤ì œ ì„ìƒ í™˜ê²½ì—ì„œì˜ í™œìš© ê°€ëŠ¥ì„±ì„ ë†’ì¸ë‹¤.


- **ì—°í•©í•™ìŠµ í™˜ê²½ì—ì„œì˜ ì‹¤ì§ˆì  ì ìš©ì„± í™•ë³´**

ë°ì´í„°ê°€ ë³‘ì›ì´ë‚˜ ê¸°ê´€ë³„ë¡œ ë¶„ì‚°ë˜ì–´ ìˆëŠ” ìƒí™©ì—ì„œë„ í”„ë¼ì´ë²„ì‹œë¥¼ ë³´ì¥í•˜ë©° í•™ìŠµí•  ìˆ˜ ìˆì–´, ì˜ë£Œ ë°ì´í„° í™œìš© ë²”ìœ„ë¥¼ í™•ëŒ€í•  ìˆ˜ ìˆë‹¤.
ì—°í•©í•™ìŠµê³¼ ì§€ì‹ ì¦ë¥˜ë¥¼ í†µí•´ ë³‘ì›ë³„ ë°ì´í„° íŠ¹ì„±ì„ ìƒí˜¸ ë³´ì™„í•  ìˆ˜ ìˆì–´, íŠ¹ì • ì§ˆí™˜ì— í¸ì¤‘ëœ í•™ìŠµ ë°ì´í„°ì˜ í•œê³„ë¥¼ ê·¹ë³µí•˜ê³  ë‹¤ì–‘í•œ ì§ˆí™˜ì— ëŒ€í•œ ì¼ë°˜í™” ì„±ëŠ¥ì„ í™•ë³´í•  ìˆ˜ ìˆë‹¤.
ê° ë³‘ì›ì´ ë³´ìœ í•˜ì§€ ì•Šì€ ì§ˆí™˜ ìœ í˜•ì— ëŒ€í•´ì„œë„ ë‹¤ë¥¸ ë³‘ì›ì˜ í•™ìŠµ ê²½í—˜ì„ ê³µìœ í•¨ìœ¼ë¡œì¨, ë³´ê³  ì‚¬ë¡€ê°€ ì ì€ í¬ê·€ ì§ˆí™˜ì´ë‚˜ ë“œë¬¸ ì§ˆí™˜ì— ëŒ€í•œ ì§„ë‹¨ ì˜ˆì¸¡ ì •í™•ë„ë¥¼ ë†’ì¼ ìˆ˜ ìˆë‹¤.


- **íš¨ìœ¨ì ì¸ ì§€ì‹ ê³µìœ **

í´ëŸ¬ìŠ¤í„°ë§ ë° Representation-level KDë¥¼ í†µí•´, ëª¨ë“  ëª¨ë‹¬ë¦¬í‹°ë¥¼ ê°€ì§„ í´ë¼ì´ì–¸íŠ¸ë¿ë§Œ ì•„ë‹ˆë¼ ê²°ì†ëœ í´ë¼ì´ì–¸íŠ¸ë„ ê¸€ë¡œë²Œ ëª¨ë¸ ì„±ëŠ¥ í–¥ìƒì— ê¸°ì—¬í•  ìˆ˜ ìˆë‹¤.


- **ì¼ë°˜í™” ì„±ëŠ¥ í–¥ìƒ**

Cross-Attention ê¸°ë°˜ ê¸€ë¡œë²Œ í‘œí˜„ í•™ìŠµì„ í†µí•´, ë‹¤ì–‘í•œ ëª¨ë‹¬ë¦¬í‹° ì¡°í•©ì—ì„œ ê°•ê±´í•˜ê²Œ ì‘ë™í•˜ëŠ” ëª¨ë¸ì„ êµ¬ì¶•í•  ìˆ˜ ìˆë‹¤.
ê²°ì† ë°ì´í„° í™˜ê²½ì—ì„œë„ ì¼ê´€ëœ ì„±ëŠ¥ì„ ë³´ì¥í•¨ìœ¼ë¡œì¨ ì˜ë£Œì§„ì´ AIë¥¼ ë³´ì¡°ì  ë„êµ¬ë¡œ ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ê¸°ë°˜ì„ ë§ˆë ¨í•œë‹¤. ë” ë‚˜ì•„ê°€, ë‹¤ì–‘í•œ ê·œëª¨ì™€ íŠ¹ì„±ì„ ê°€ì§„ ë³‘ì›ë“¤ë¡œ í™•ì¥ ì ìš©ì´ ê°€ëŠ¥í•´ ì˜ë£Œ AIì˜ ë³´ê¸‰ê³¼ ì‹¤ì§ˆì  ì„ìƒ ì ìš©ì„ ì´‰ì§„í•  ìˆ˜ ìˆë‹¤.


## ì‹¤í–‰ ë°©ë²•

# ì˜ˆì‹œ ì‹¤í–‰ ì½”ë“œ (Python ê°€ìƒí™˜ê²½ í™œì„±í™” í›„)
```
python train_clients.py  # ëª¨ë“  í´ë¼ì´ì–¸íŠ¸ ê°œë³„ í•™ìŠµ
python aggregate_vectors.py  # ì„œë²„ì—ì„œ ë²¡í„° ìœµí•©
python update_clients.py  # í´ë¼ì´ì–¸íŠ¸ê°€ ê¸€ë¡œë²Œ ì •ë³´ ë°˜ì˜
â€» ì‹¤ì œ ì‹¤í–‰ ì‹œ, í´ë¼ì´ì–¸íŠ¸ë³„ ë””ë ‰í† ë¦¬ êµ¬ì„±ê³¼ í™˜ê²½ ì„¤ì •ì´ í•„ìš”í•©ë‹ˆë‹¤.
```

# ì‹¤í–‰ ê²°ê³¼ (ì¼ë¶€)
```
======================================================================
[GpuMonitor] pynvml initialized. Monitoring GPU 0.
[GpuMonitor] Monitor thread started. Logging to: outputs\client_17\client_17_gpu_update_v2_log.csv
[client_17] Data loaded: mode=image_only, total=6500 (train=5850, val=650)
[client_17] Z loaded: shape=(6, 256)
[client_17] Baseline (on 10% val): {'loss': 0.25629968368090117, 'f1_micro': 0.33121019108280253, 'f1_macro': 0.13120336158174845, 'auc_macro': 0.7156502858959265}
[Ep 1/2] train_loss_main=0.2263 | train_loss_z=0.0999 | val_loss=0.2576 | val_f1_macro=0.1963
[Ep 2/2] train_loss_main=0.2212 | train_loss_z=0.0998 | val_loss=0.2584 | val_f1_macro=0.1795
[client_17] Updated (on 10% val): {'loss': 0.25841172236662646, 'f1_micro': 0.3977110157367668, 'f1_macro': 0.1795058143964308, 'auc_macro': 0.7305021626201271}
[client 17] updated full model (head only trained) saved â†’ outputs\client_17\updated_heads_v2.pt
[GpuMonitor] Stopping monitor thread...
[GpuMonitor] pynvml shutdown.
[GpuMonitor] Monitor stopped.
======================================================================

======================================================================
â–¶ Client 18 | V2 Update starting...
======================================================================
[GpuMonitor] pynvml initialized. Monitoring GPU 0.
[GpuMonitor] Monitor thread started. Logging to: outputs\client_18\client_18_gpu_update_v2_log.csv
[client_18] Data loaded: mode=image_only, total=6500 (train=5850, val=650)
[client_18] Z loaded: shape=(6, 256)
[client_18] Baseline (on 10% val): {'loss': 0.26852639441306775, 'f1_micro': 0.29635258358662614, 'f1_macro': 0.10324139965980333, 'auc_macro': 0.7127173861949362}
[Ep 1/2] train_loss_main=0.2370 | train_loss_z=0.0999 | val_loss=0.2711 | val_f1_macro=0.1248
[Ep 2/2] train_loss_main=0.2328 | train_loss_z=0.0999 | val_loss=0.2725 | val_f1_macro=0.1450
[client_18] Updated (on 10% val): {'loss': 0.2724794720686399, 'f1_micro': 0.34425087108013935, 'f1_macro': 0.14499985233250504, 'auc_macro': 0.7173449486719888}
[client 18] updated full model (head only trained) saved â†’ outputs\client_18\updated_heads_v2.pt
[GpuMonitor] Stopping monitor thread...
[GpuMonitor] pynvml shutdown.
[GpuMonitor] Monitor stopped.
======================================================================

======================================================================
â–¶ Client 19 | V2 Update starting...
======================================================================
[GpuMonitor] pynvml initialized. Monitoring GPU 0.
[GpuMonitor] Monitor thread started. Logging to: outputs\client_19\client_19_gpu_update_v2_log.csv
[client_19] Data loaded: mode=text_only, total=6500 (train=5850, val=650)
[client_19] Z loaded: shape=(6, 256)
[client_19] Baseline (on 10% val): {'loss': 0.08519376436105142, 'f1_micro': 0.9015228426395939, 'f1_macro': 0.7576292943247303, 'auc_macro': 0.9599142797966776}
[Ep 1/2] train_loss_main=0.0569 | train_loss_z=0.0829 | val_loss=0.0804 | val_f1_macro=0.7663
[Ep 2/2] train_loss_main=0.0544 | train_loss_z=0.0538 | val_loss=0.0815 | val_f1_macro=0.7637
[client_19] Updated (on 10% val): {'loss': 0.08153150638708702, 'f1_micro': 0.9020408163265307, 'f1_macro': 0.7637201752682804, 'auc_macro': 0.9667219507823445}
[client 19] updated full model (head only trained) saved â†’ outputs\client_19\updated_heads_v2.pt
[GpuMonitor] Stopping monitor thread...
[GpuMonitor] pynvml shutdown.
[GpuMonitor] Monitor stopped.
======================================================================

======================================================================
â–¶ Client 20 | V2 Update starting...
======================================================================
[GpuMonitor] pynvml initialized. Monitoring GPU 0.
[GpuMonitor] Monitor thread started. Logging to: outputs\client_20\client_20_gpu_update_v2_log.csv
[client_20] Data loaded: mode=text_only, total=6500 (train=5850, val=650)
[client_20] Z loaded: shape=(6, 256)
[client_20] Baseline (on 10% val): {'loss': 0.08118169743281145, 'f1_micro': 0.8712394705174489, 'f1_macro': 0.7400537378061134, 'auc_macro': 0.9763209058549491}
[Ep 1/2] train_loss_main=0.0582 | train_loss_z=0.0830 | val_loss=0.0818 | val_f1_macro=0.7431
[Ep 2/2] train_loss_main=0.0576 | train_loss_z=0.0539 | val_loss=0.0835 | val_f1_macro=0.7457
[client_20] Updated (on 10% val): {'loss': 0.0834647752229984, 'f1_micro': 0.8724035608308606, 'f1_macro': 0.745670013520273, 'auc_macro': 0.9765838694746376}
[client 20] updated full model (head only trained) saved â†’ outputs\client_20\updated_heads_v2.pt
[GpuMonitor] Stopping monitor thread...
[GpuMonitor] pynvml shutdown.
[GpuMonitor] Monitor stopped.
...
```

## ì‚¬ìš© ê¸°ìˆ 
- Python, PyTorch

- HuggingFace Transformers

- torchvision (MobileNetV3)

- ì—°í•© í•™ìŠµ êµ¬ì¡° (custom FL pipeline)

- Gating Mechanism ê¸°ë°˜ Late Fusion
